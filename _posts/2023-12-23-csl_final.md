---
layout: post
title: Reward Engineering for Robot Dancing
subtitle: 6.8200 Final Project
thumbnail-img: /assets/img/robot_image.png
mathjax: true
---

This was my team's final project for 6.8200, Computational Sensorimotor Learning, where we tried to teach a virtual robot to dance.

## Introduction

There are many difficulties associated in designing rewards for certain tasks in robotics and reinforcement learning, particularly for those involving subjectivity and creativity, as reward functions play a massive role on the final learned policy. Thus, we want to see whether we can design a reward function to incentivize a quadruped robot to "learn" how to dance.

## Methodology

Our goal: given a robot with a trained policy for walking, can we "teach" it to dance and move to a given beat?

- **Observation space**: General dynamics equations of the quadruped (position of CoM, Roll, Pitch, Yaw, joint orientations)
- **Action space**: Scaled torques for 4 hip joints (2 degrees of freedom) and 4 knee joints (1 degree)
- **Learning algorithm**: Proximal Policy Optimization (PPO)

### What is "good" dance?

As "good" dance is difficult to objectively define, we aim to create some criteria to reward to hopefully achieve this:

- Positive reward for variation in joint position, bot speed/acceleration
- Positive reward for regular intervals between movements (timeliness)
- Negative reward for body/limbs on ground/contacts

## Experimentation

We try to incentivize the following:

- Rewarding variation

![rewarding-variation](/assets/img/robot-1.gif){: .mx-auto.d-block :}

- Penalizing falling

![penalizing-falling](/assets/img/robot-2.gif){: .mx-auto.d-block :}

- Rewarding timeliness

![rewarding-timeliness](/assets/img/robot-3.gif){: .mx-auto.d-block :}

- Scaling weights

![scaling-weights](/assets/img/robot-4.gif){: .mx-auto.d-block :}

## Final Output

This was the final video we got, along with graphs of its velocity and joint positions.

![final-robot](/assets/img/robot-final.gif){: .mx-auto.d-block :}
![final-policy](/assets/img/final-policy.png){: .mx-auto.d-block :}

## Final Thoughts

You can see some semblance of dance in the final video, although it is far from perfect (due to our limitations). It would've been cool to teach it to sync to input music as well, but that would've been too much for a single final project.
